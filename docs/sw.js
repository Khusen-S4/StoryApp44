const BASE_PATH="/StoryApp44/",CACHE_NAME="story-app-v3";self.addEventListener("push",(t=>{console.log("[SW] Push event diterima");let e={title:"Story Baru ðŸŽ‰",body:"Ada story baru yang ditambahkan"};if(t.data)try{e=t.data.json()}catch{e.body=t.data.text()}const a={body:e.body,icon:`${BASE_PATH}icons/icon-192x192.png`,badge:`${BASE_PATH}icons/icon-192x192.png`};t.waitUntil(self.registration.showNotification(e.title,a))})),self.addEventListener("message",(t=>{if("NEW_STORY"!==t.data?.type)return;const{title:e,body:a}=t.data.payload;self.registration.showNotification(e,{body:a,icon:`${BASE_PATH}icons/icon-192x192.png`,badge:`${BASE_PATH}icons/icon-192x192.png`})})),self.addEventListener("install",(t=>{t.waitUntil(caches.open(CACHE_NAME).then((t=>t.addAll([BASE_PATH,`${BASE_PATH}index.html`,`${BASE_PATH}manifest.json`,`${BASE_PATH}images/marker-bawah.png`,`${BASE_PATH}images/gambar-error.png`,`${BASE_PATH}images/st317.png`])))),self.skipWaiting()})),self.addEventListener("activate",(t=>{t.waitUntil(caches.keys().then((t=>Promise.all(t.map((t=>{if(t!==CACHE_NAME)return caches.delete(t)})))))),self.clients.claim()})),self.addEventListener("fetch",(t=>{if("GET"!==t.request.method)return;const e=new URL(t.request.url);"https://story-api.dicoding.dev"===e.origin&&e.pathname.startsWith("/v1/stories")?t.respondWith(caches.open(CACHE_NAME).then((async e=>{try{const a=await fetch(t.request);return e.put(t.request,a.clone()),a}catch{return e.match(t.request)}}))):t.respondWith(caches.match(t.request).then((e=>e||fetch(t.request))))}));