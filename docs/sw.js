self.addEventListener("push",(t=>{console.log("[SW] Push event diterima");let e={title:"Story Baru ðŸŽ‰",body:"Ada story baru yang ditambahkan"};if(t.data)try{e=t.data.json()}catch(n){e.body=t.data.text()}console.log("[SW] Data push:",e);const n={body:e.body,icon:"/icons/icon-192x192.png",badge:"/icons/icon-192x192.png"};t.waitUntil(self.registration.showNotification(e.title,n))})),self.addEventListener("message",(t=>{if("NEW_STORY"!==t.data?.type)return;const{title:e,body:n}=t.data.payload;self.registration.showNotification(e,{body:n,icon:"/icons/icon-192x192.png",badge:"/icons/icon-192x192.png"})}));const CACHE_NAME="story-app-v2",ASSETS=["/","/index.html","/manifest.json","/images/marker-bawah.png","/images/gambar-error.png","/images/st317.png"];self.addEventListener("install",(t=>{t.waitUntil(caches.open(CACHE_NAME).then((t=>t.addAll(ASSETS))))})),self.addEventListener("activate",(t=>{t.waitUntil(self.clients.claim())})),self.addEventListener("fetch",(t=>{if("GET"!==t.request.method)return;const e=new URL(t.request.url);"https://story-api.dicoding.dev"===e.origin&&e.pathname.startsWith("/v1/stories")?t.respondWith(caches.open(CACHE_NAME).then((async e=>{try{const n=await fetch(t.request);return e.put(t.request,n.clone()),n}catch(n){return e.match(t.request)}}))):t.respondWith(caches.match(t.request).then((e=>e||fetch(t.request))))}));